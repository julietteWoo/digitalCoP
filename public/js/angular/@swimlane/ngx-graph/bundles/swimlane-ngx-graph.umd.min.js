!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/core"),require("@swimlane/ngx-charts"),require("d3-selection"),require("d3-shape"),require("d3-ease"),require("d3-transition"),require("rxjs"),require("rxjs/operators"),require("transformation-matrix"),require("dagre"),require("d3-force"),require("webcola"),require("d3-dispatch"),require("d3-timer")):"function"==typeof define&&define.amd?define("@swimlane/ngx-graph",["exports","@angular/core","@swimlane/ngx-charts","d3-selection","d3-shape","d3-ease","d3-transition","rxjs","rxjs/operators","transformation-matrix","dagre","d3-force","webcola","d3-dispatch","d3-timer"],e):e(((t=t||self).swimlane=t.swimlane||{},t.swimlane["ngx-graph"]={}),t.ng.core,t.ngxCharts,t.d3Selection,t.d3Shape,t.d3Ease,null,t.rxjs,t.rxjs.operators,t.transformationMatrix,t.dagre,t.d3Force,t.webcola,t.d3Dispatch,t.d3Timer)}(this,(function(t,e,n,i,o,r,s,a,d,p,h,u,g,l,c){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */var m=function(t,e){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};var f=function(){return(f=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};function y(t,e,n,i){var o,r=arguments.length,s=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,n,s):o(e,n))||s);return r>3&&s&&Object.defineProperty(e,n,s),s}function v(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}function x(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],i=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function b(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var i,o,r=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(i=r.next()).done;)s.push(i.value)}catch(t){o={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(o)throw o.error}}return s}function w(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(b(arguments[e]));return t}var O,M,T={};function G(){var t=("0000"+(Math.random()*Math.pow(36,4)<<0).toString(36)).slice(-4);return T[t="a"+t]?G():(T[t]=!0,t)}(O=t.Orientation||(t.Orientation={})).LEFT_TO_RIGHT="LR",O.RIGHT_TO_LEFT="RL",O.TOP_TO_BOTTOM="TB",O.BOTTOM_TO_TOM="BT",(M=t.Alignment||(t.Alignment={})).CENTER="C",M.UP_LEFT="UL",M.UP_RIGHT="UR",M.DOWN_LEFT="DL",M.DOWN_RIGHT="DR";var L=function(){function e(){this.defaultSettings={orientation:t.Orientation.LEFT_TO_RIGHT,marginX:20,marginY:20,edgePadding:100,rankPadding:100,nodePadding:50,multigraph:!0,compound:!0},this.settings={}}return e.prototype.run=function(t){this.createDagreGraph(t),h.layout(this.dagreGraph),t.edgeLabels=this.dagreGraph._edgeLabels;var e=function(e){var i=n.dagreGraph._nodes[e],o=t.nodes.find((function(t){return t.id===i.id}));o.position={x:i.x,y:i.y},o.dimension={width:i.width,height:i.height}},n=this;for(var i in this.dagreGraph._nodes)e(i);return t},e.prototype.updateEdge=function(t,e){var n=t.nodes.find((function(t){return t.id===e.source})),i=t.nodes.find((function(t){return t.id===e.target})),o=n.position.y<=i.position.y?-1:1,r={x:n.position.x,y:n.position.y-o*(n.dimension.height/2)},s={x:i.position.x,y:i.position.y+o*(i.dimension.height/2)};return e.points=[r,s],t},e.prototype.createDagreGraph=function(t){var e,n,i,o,r=Object.assign({},this.defaultSettings,this.settings);this.dagreGraph=new h.graphlib.Graph({compound:r.compound,multigraph:r.multigraph}),this.dagreGraph.setGraph({rankdir:r.orientation,marginx:r.marginX,marginy:r.marginY,edgesep:r.edgePadding,ranksep:r.rankPadding,nodesep:r.nodePadding,align:r.align,acyclicer:r.acyclicer,ranker:r.ranker,multigraph:r.multigraph,compound:r.compound}),this.dagreGraph.setDefaultEdgeLabel((function(){return{}})),this.dagreNodes=t.nodes.map((function(t){var e=Object.assign({},t);return e.width=t.dimension.width,e.height=t.dimension.height,e.x=t.position.x,e.y=t.position.y,e})),this.dagreEdges=t.edges.map((function(t){var e=Object.assign({},t);return e.id||(e.id=G()),e}));try{for(var s=x(this.dagreNodes),a=s.next();!a.done;a=s.next()){var d=a.value;d.width||(d.width=20),d.height||(d.height=30),this.dagreGraph.setNode(d.id,d)}}catch(t){e={error:t}}finally{try{a&&!a.done&&(n=s.return)&&n.call(s)}finally{if(e)throw e.error}}try{for(var p=x(this.dagreEdges),u=p.next();!u.done;u=p.next()){var g=u.value;r.multigraph?this.dagreGraph.setEdge(g.source,g.target,g,g.id):this.dagreGraph.setEdge(g.source,g.target)}}catch(t){i={error:t}}finally{try{u&&!u.done&&(o=p.return)&&o.call(p)}finally{if(i)throw i.error}}return this.dagreGraph},e}(),D=function(){function e(){this.defaultSettings={orientation:t.Orientation.LEFT_TO_RIGHT,marginX:20,marginY:20,edgePadding:100,rankPadding:100,nodePadding:50,multigraph:!0,compound:!0},this.settings={}}return e.prototype.run=function(t){var e=this;this.createDagreGraph(t),h.layout(this.dagreGraph),t.edgeLabels=this.dagreGraph._edgeLabels;var n=function(t){var n=e.dagreGraph._nodes[t.id];return f(f({},t),{position:{x:n.x,y:n.y},dimension:{width:n.width,height:n.height}})};return t.clusters=(t.clusters||[]).map(n),t.nodes=t.nodes.map(n),t},e.prototype.updateEdge=function(t,e){var n=t.nodes.find((function(t){return t.id===e.source})),i=t.nodes.find((function(t){return t.id===e.target})),o=n.position.y<=i.position.y?-1:1,r={x:n.position.x,y:n.position.y-o*(n.dimension.height/2)},s={x:i.position.x,y:i.position.y+o*(i.dimension.height/2)};return e.points=[r,s],t},e.prototype.createDagreGraph=function(t){var e,n,i,o,r,s,a=this,d=Object.assign({},this.defaultSettings,this.settings);this.dagreGraph=new h.graphlib.Graph({compound:d.compound,multigraph:d.multigraph}),this.dagreGraph.setGraph({rankdir:d.orientation,marginx:d.marginX,marginy:d.marginY,edgesep:d.edgePadding,ranksep:d.rankPadding,nodesep:d.nodePadding,align:d.align,acyclicer:d.acyclicer,ranker:d.ranker,multigraph:d.multigraph,compound:d.compound}),this.dagreGraph.setDefaultEdgeLabel((function(){return{}})),this.dagreNodes=t.nodes.map((function(t){var e=Object.assign({},t);return e.width=t.dimension.width,e.height=t.dimension.height,e.x=t.position.x,e.y=t.position.y,e})),this.dagreClusters=t.clusters||[],this.dagreEdges=t.edges.map((function(t){var e=Object.assign({},t);return e.id||(e.id=G()),e}));try{for(var p=x(this.dagreNodes),u=p.next();!u.done;u=p.next()){var g=u.value;this.dagreGraph.setNode(g.id,g)}}catch(t){e={error:t}}finally{try{u&&!u.done&&(n=p.return)&&n.call(p)}finally{if(e)throw e.error}}var l=function(t){c.dagreGraph.setNode(t.id,t),t.childNodeIds.forEach((function(e){a.dagreGraph.setParent(e,t.id)}))},c=this;try{for(var m=x(this.dagreClusters),f=m.next();!f.done;f=m.next()){l(f.value)}}catch(t){i={error:t}}finally{try{f&&!f.done&&(o=m.return)&&o.call(m)}finally{if(i)throw i.error}}try{for(var y=x(this.dagreEdges),v=y.next();!v.done;v=y.next()){var b=v.value;d.multigraph?this.dagreGraph.setEdge(b.source,b.target,b,b.id):this.dagreGraph.setEdge(b.source,b.target)}}catch(t){r={error:t}}finally{try{v&&!v.done&&(s=y.return)&&s.call(y)}finally{if(r)throw r.error}}return this.dagreGraph},e}(),E=function(){function e(){this.defaultSettings={orientation:t.Orientation.LEFT_TO_RIGHT,marginX:20,marginY:20,edgePadding:100,rankPadding:100,nodePadding:50,curveDistance:20,multigraph:!0,compound:!0},this.settings={}}return e.prototype.run=function(t){var e,n;this.createDagreGraph(t),h.layout(this.dagreGraph),t.edgeLabels=this.dagreGraph._edgeLabels;var i=function(e){var n=o.dagreGraph._nodes[e],i=t.nodes.find((function(t){return t.id===n.id}));i.position={x:n.x,y:n.y},i.dimension={width:n.width,height:n.height}},o=this;for(var r in this.dagreGraph._nodes)i(r);try{for(var s=x(t.edges),a=s.next();!a.done;a=s.next()){var d=a.value;this.updateEdge(t,d)}}catch(t){e={error:t}}finally{try{a&&!a.done&&(n=s.return)&&n.call(s)}finally{if(e)throw e.error}}return t},e.prototype.updateEdge=function(t,e){var n,i,o,r,s=t.nodes.find((function(t){return t.id===e.source})),a=t.nodes.find((function(t){return t.id===e.target})),d="BT"===this.settings.orientation||"TB"===this.settings.orientation?"y":"x",p="y"===d?"x":"y",h="y"===d?"height":"width",u=s.position[d]<=a.position[d]?-1:1,g=((n={})[p]=s.position[p],n[d]=s.position[d]-u*(s.dimension[h]/2),n),l=((i={})[p]=a.position[p],i[d]=a.position[d]+u*(a.dimension[h]/2),i),c=this.settings.curveDistance||this.defaultSettings.curveDistance;e.points=[g,(o={},o[p]=g[p],o[d]=g[d]-u*c,o),(r={},r[p]=l[p],r[d]=l[d]+u*c,r),l];var m=e.source+""+e.target+"\0",f=t.edgeLabels[m];return f&&(f.points=e.points),t},e.prototype.createDagreGraph=function(t){var e,n,i,o,r=Object.assign({},this.defaultSettings,this.settings);this.dagreGraph=new h.graphlib.Graph({compound:r.compound,multigraph:r.multigraph}),this.dagreGraph.setGraph({rankdir:r.orientation,marginx:r.marginX,marginy:r.marginY,edgesep:r.edgePadding,ranksep:r.rankPadding,nodesep:r.nodePadding,align:r.align,acyclicer:r.acyclicer,ranker:r.ranker,multigraph:r.multigraph,compound:r.compound}),this.dagreGraph.setDefaultEdgeLabel((function(){return{}})),this.dagreNodes=t.nodes.map((function(t){var e=Object.assign({},t);return e.width=t.dimension.width,e.height=t.dimension.height,e.x=t.position.x,e.y=t.position.y,e})),this.dagreEdges=t.edges.map((function(t){var e=Object.assign({},t);return e.id||(e.id=G()),e}));try{for(var s=x(this.dagreNodes),a=s.next();!a.done;a=s.next()){var d=a.value;d.width||(d.width=20),d.height||(d.height=30),this.dagreGraph.setNode(d.id,d)}}catch(t){e={error:t}}finally{try{a&&!a.done&&(n=s.return)&&n.call(s)}finally{if(e)throw e.error}}try{for(var p=x(this.dagreEdges),u=p.next();!u.done;u=p.next()){var g=u.value;r.multigraph?this.dagreGraph.setEdge(g.source,g.target,g,g.id):this.dagreGraph.setEdge(g.source,g.target)}}catch(t){i={error:t}}finally{try{u&&!u.done&&(o=p.return)&&o.call(p)}finally{if(i)throw i.error}}return this.dagreGraph},e}();function k(t){return"string"==typeof t?{id:t,x:0,y:0}:t}var S=function(){function t(){this.defaultSettings={force:u.forceSimulation().force("charge",u.forceManyBody().strength(-150)).force("collide",u.forceCollide(5)),forceLink:u.forceLink().id((function(t){return t.id})).distance((function(){return 100}))},this.settings={},this.outputGraph$=new a.Subject}return t.prototype.run=function(t){var e=this;return this.inputGraph=t,this.d3Graph={nodes:w(this.inputGraph.nodes.map((function(t){return f({},t)}))),edges:w(this.inputGraph.edges.map((function(t){return f({},t)})))},this.outputGraph={nodes:[],edges:[],edgeLabels:[]},this.outputGraph$.next(this.outputGraph),this.settings=Object.assign({},this.defaultSettings,this.settings),this.settings.force&&this.settings.force.nodes(this.d3Graph.nodes).force("link",this.settings.forceLink.links(this.d3Graph.edges)).alpha(.5).restart().on("tick",(function(){e.outputGraph$.next(e.d3GraphToOutputGraph(e.d3Graph))})),this.outputGraph$.asObservable()},t.prototype.updateEdge=function(t,e){var n=this,i=Object.assign({},this.defaultSettings,this.settings);return i.force&&i.force.nodes(this.d3Graph.nodes).force("link",i.forceLink.links(this.d3Graph.edges)).alpha(.5).restart().on("tick",(function(){n.outputGraph$.next(n.d3GraphToOutputGraph(n.d3Graph))})),this.outputGraph$.asObservable()},t.prototype.d3GraphToOutputGraph=function(t){return this.outputGraph.nodes=this.d3Graph.nodes.map((function(t){return f(f({},t),{id:t.id||G(),position:{x:t.x,y:t.y},dimension:{width:t.dimension&&t.dimension.width||20,height:t.dimension&&t.dimension.height||20},transform:"translate("+(t.x-(t.dimension&&t.dimension.width||20)/2||0)+", "+(t.y-(t.dimension&&t.dimension.height||20)/2||0)+")"})})),this.outputGraph.edges=this.d3Graph.edges.map((function(t){return f(f({},t),{source:k(t.source).id,target:k(t.target).id,points:[{x:k(t.source).x,y:k(t.source).y},{x:k(t.target).x,y:k(t.target).y}]})})),this.outputGraph.edgeLabels=this.outputGraph.edges,this.outputGraph},t.prototype.onDragStart=function(t,e){this.settings.force.alphaTarget(.3).restart();var n=this.d3Graph.nodes.find((function(e){return e.id===t.id}));n&&(this.draggingStart={x:e.x-n.x,y:e.y-n.y},n.fx=e.x-this.draggingStart.x,n.fy=e.y-this.draggingStart.y)},t.prototype.onDrag=function(t,e){if(t){var n=this.d3Graph.nodes.find((function(e){return e.id===t.id}));n&&(n.fx=e.x-this.draggingStart.x,n.fy=e.y-this.draggingStart.y)}},t.prototype.onDragEnd=function(t,e){if(t){var n=this.d3Graph.nodes.find((function(e){return e.id===t.id}));n&&(this.settings.force.alphaTarget(0),n.fx=void 0,n.fy=void 0)}},t}();function C(t,e){return"number"==typeof e?t[e]:e}var I,N,P=function(){function t(){this.defaultSettings={force:g.d3adaptor(f(f(f({},l),u),c)).linkDistance(150).avoidOverlaps(!0),viewDimensions:{width:600,height:600,xOffset:0}},this.settings={},this.outputGraph$=new a.Subject}return t.prototype.run=function(t){var e=this;return this.inputGraph=t,this.inputGraph.clusters||(this.inputGraph.clusters=[]),this.internalGraph={nodes:w(this.inputGraph.nodes.map((function(t){return f(f({},t),{width:t.dimension?t.dimension.width:20,height:t.dimension?t.dimension.height:20})}))),groups:w(this.inputGraph.clusters.map((function(t){return{padding:5,groups:t.childNodeIds.map((function(t){return e.inputGraph.clusters.findIndex((function(e){return e.id===t}))})).filter((function(t){return t>=0})),leaves:t.childNodeIds.map((function(t){return e.inputGraph.nodes.findIndex((function(e){return e.id===t}))})).filter((function(t){return t>=0}))}}))),links:w(this.inputGraph.edges.map((function(t){var n=e.inputGraph.nodes.findIndex((function(e){return t.source===e.id})),i=e.inputGraph.nodes.findIndex((function(e){return t.target===e.id}));if(-1!==n&&-1!==i)return f(f({},t),{source:n,target:i})})).filter((function(t){return!!t}))),groupLinks:w(this.inputGraph.edges.map((function(t){var n=e.inputGraph.nodes.findIndex((function(e){return t.source===e.id})),i=e.inputGraph.nodes.findIndex((function(e){return t.target===e.id}));if(!(n>=0&&i>=0))return t})).filter((function(t){return!!t})))},this.outputGraph={nodes:[],clusters:[],edges:[],edgeLabels:[]},this.outputGraph$.next(this.outputGraph),this.settings=Object.assign({},this.defaultSettings,this.settings),this.settings.force&&(this.settings.force=this.settings.force.nodes(this.internalGraph.nodes).groups(this.internalGraph.groups).links(this.internalGraph.links).alpha(.5).on("tick",(function(){e.settings.onTickListener&&e.settings.onTickListener(e.internalGraph),e.outputGraph$.next(e.internalGraphToOutputGraph(e.internalGraph))})),this.settings.viewDimensions&&(this.settings.force=this.settings.force.size([this.settings.viewDimensions.width,this.settings.viewDimensions.height])),this.settings.forceModifierFn&&(this.settings.force=this.settings.forceModifierFn(this.settings.force)),this.settings.force.start()),this.outputGraph$.asObservable()},t.prototype.updateEdge=function(t,e){var n=Object.assign({},this.defaultSettings,this.settings);return n.force&&n.force.start(),this.outputGraph$.asObservable()},t.prototype.internalGraphToOutputGraph=function(t){var e=this;return this.outputGraph.nodes=t.nodes.map((function(t){return f(f({},t),{id:t.id||G(),position:{x:t.x,y:t.y},dimension:{width:t.dimension&&t.dimension.width||20,height:t.dimension&&t.dimension.height||20},transform:"translate("+(t.x-(t.dimension&&t.dimension.width||20)/2||0)+", "+(t.y-(t.dimension&&t.dimension.height||20)/2||0)+")"})})),this.outputGraph.edges=t.links.map((function(e){var n=C(t.nodes,e.source),i=C(t.nodes,e.target);return f(f({},e),{source:n.id,target:i.id,points:[n.bounds.rayIntersection(i.bounds.cx(),i.bounds.cy()),i.bounds.rayIntersection(n.bounds.cx(),n.bounds.cy())]})})).concat(t.groupLinks.map((function(e){var n=t.nodes.find((function(t){return t.id===e.source})),i=t.nodes.find((function(t){return t.id===e.target})),o=n||t.groups.find((function(t){return t.id===e.source})),r=i||t.groups.find((function(t){return t.id===e.target}));return f(f({},e),{source:o.id,target:r.id,points:[o.bounds.rayIntersection(r.bounds.cx(),r.bounds.cy()),r.bounds.rayIntersection(o.bounds.cx(),o.bounds.cy())]})}))),this.outputGraph.clusters=t.groups.map((function(t,n){var i=e.inputGraph.clusters[n];return f(f({},i),{dimension:{width:t.bounds?t.bounds.width():20,height:t.bounds?t.bounds.height():20},position:{x:t.bounds?t.bounds.x+t.bounds.width()/2:0,y:t.bounds?t.bounds.y+t.bounds.height()/2:0}})})),this.outputGraph.edgeLabels=this.outputGraph.edges,this.outputGraph},t.prototype.onDragStart=function(t,e){var n=this.outputGraph.nodes.findIndex((function(e){return e.id===t.id})),i=this.internalGraph.nodes[n];i&&(this.draggingStart={x:i.x-e.x,y:i.y-e.y},i.fixed=1,this.settings.force.start())},t.prototype.onDrag=function(t,e){if(t){var n=this.outputGraph.nodes.findIndex((function(e){return e.id===t.id})),i=this.internalGraph.nodes[n];i&&(i.x=this.draggingStart.x+e.x,i.y=this.draggingStart.y+e.y)}},t.prototype.onDragEnd=function(t,e){if(t){var n=this.outputGraph.nodes.findIndex((function(e){return e.id===t.id})),i=this.internalGraph.nodes[n];i&&(i.fixed=0)}},t}(),j={dagre:L,dagreCluster:D,dagreNodesOnly:E,d3ForceDirected:S,colaForceDirected:P},z=function(){function t(){}return t.prototype.getLayout=function(t){if(j[t])return new j[t];throw new Error("Unknown layout type '"+t+"'")},t=y([e.Injectable()],t)}();function _(t,e,n){var i,o,r;n=n||{};var s=null,a=0;function d(){a=!1===n.leading?0:+new Date,s=null,r=t.apply(i,o)}return function(){var p=+new Date;a||!1!==n.leading||(a=p);var h=e-(p-a);return i=this,o=arguments,h<=0?(clearTimeout(s),s=null,a=p,r=t.apply(i,o)):s||!1===n.trailing||(s=setTimeout(d,h)),r}}function F(t,e){return function(n,i,o){return{configurable:!0,enumerable:o.enumerable,get:function(){return Object.defineProperty(this,i,{configurable:!0,enumerable:o.enumerable,value:_(o.value,t,e)}),this[i]}}}}(I=t.PanningAxis||(t.PanningAxis={})).Both="both",I.Horizontal="horizontal",I.Vertical="vertical",(N=t.MiniMapPosition||(t.MiniMapPosition={})).UpperLeft="UpperLeft",N.UpperRight="UpperRight";var $=function(s){function h(n,i,o,r){var d=s.call(this,n,i,o)||this;return d.el=n,d.zone=i,d.cd=o,d.layoutService=r,d.legend=!1,d.nodes=[],d.clusters=[],d.links=[],d.activeEntries=[],d.draggingEnabled=!0,d.panningEnabled=!0,d.panningAxis=t.PanningAxis.Both,d.enableZoom=!0,d.zoomSpeed=.1,d.minZoomLevel=.1,d.maxZoomLevel=4,d.autoZoom=!1,d.panOnZoom=!0,d.animate=!1,d.autoCenter=!1,d.enableTrackpadSupport=!1,d.showMiniMap=!1,d.miniMapMaxWidth=100,d.miniMapPosition=t.MiniMapPosition.UpperRight,d.activate=new e.EventEmitter,d.deactivate=new e.EventEmitter,d.zoomChange=new e.EventEmitter,d.clickHandler=new e.EventEmitter,d.isMouseMoveCalled=!1,d.graphSubscription=new a.Subscription,d.subscriptions=[],d.margin=[0,0,0,0],d.results=[],d.isPanning=!1,d.isDragging=!1,d.initialized=!1,d.graphDims={width:0,height:0},d._oldLinks=[],d.oldNodes=new Set,d.oldClusters=new Set,d.transformationMatrix=p.identity(),d._touchLastX=null,d._touchLastY=null,d.minimapScaleCoefficient=3,d.minimapOffsetX=0,d.minimapOffsetY=0,d.isMinimapPanning=!1,d.groupResultsBy=function(t){return t.label},d}return function(t,e){function n(){this.constructor=t}m(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(h,s),Object.defineProperty(h.prototype,"zoomLevel",{get:function(){return this.transformationMatrix.a},set:function(t){this.zoomTo(Number(t))},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"panOffsetX",{get:function(){return this.transformationMatrix.e},set:function(t){this.panTo(Number(t),null)},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"panOffsetY",{get:function(){return this.transformationMatrix.f},set:function(t){this.panTo(null,Number(t))},enumerable:!0,configurable:!0}),h.prototype.ngOnInit=function(){var t=this;this.update$&&this.subscriptions.push(this.update$.subscribe((function(){t.update()}))),this.center$&&this.subscriptions.push(this.center$.subscribe((function(){t.center()}))),this.zoomToFit$&&this.subscriptions.push(this.zoomToFit$.subscribe((function(){t.zoomToFit()}))),this.panToNode$&&this.subscriptions.push(this.panToNode$.subscribe((function(e){t.panToNodeId(e)}))),this.minimapClipPathId="minimapClip"+G()},h.prototype.ngOnChanges=function(t){t.layout;var e=t.layoutSettings;t.nodes,t.clusters,t.links;this.setLayout(this.layout),e&&this.setLayoutSettings(this.layoutSettings),this.update()},h.prototype.setLayout=function(t){this.initialized=!1,t||(t="dagre"),"string"==typeof t&&(this.layout=this.layoutService.getLayout(t),this.setLayoutSettings(this.layoutSettings))},h.prototype.setLayoutSettings=function(t){this.layout&&"string"!=typeof this.layout&&(this.layout.settings=t)},h.prototype.ngOnDestroy=function(){var t,e;s.prototype.ngOnDestroy.call(this);try{for(var n=x(this.subscriptions),i=n.next();!i.done;i=n.next()){i.value.unsubscribe()}}catch(e){t={error:e}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.subscriptions=null},h.prototype.ngAfterViewInit=function(){var t=this;s.prototype.ngAfterViewInit.call(this),setTimeout((function(){return t.update()}))},h.prototype.update=function(){var t=this;s.prototype.update.call(this),this.curve||(this.curve=o.curveBundle.beta(1)),this.zone.run((function(){t.dims=n.calculateViewDimensions({width:t.width,height:t.height,margins:t.margin,showLegend:t.legend}),t.seriesDomain=t.getSeriesDomain(),t.setColors(),t.legendOptions=t.getLegendOptions(),t.createGraph(),t.updateTransform(),t.initialized=!0}))},h.prototype.createGraph=function(){var t=this;this.graphSubscription.unsubscribe(),this.graphSubscription=new a.Subscription;var e=function(e){return e.meta||(e.meta={}),e.id||(e.id=G()),e.dimension?e.meta.forceDimensions=void 0===e.meta.forceDimensions||e.meta.forceDimensions:(e.dimension={width:t.nodeWidth?t.nodeWidth:30,height:t.nodeHeight?t.nodeHeight:30},e.meta.forceDimensions=!1),e.position={x:0,y:0},e.data=e.data?e.data:{},e};this.graph={nodes:this.nodes.length>0?w(this.nodes).map(e):[],clusters:this.clusters&&this.clusters.length>0?w(this.clusters).map(e):[],edges:this.links.length>0?w(this.links).map((function(t){return t.id||(t.id=G()),t})):[]},requestAnimationFrame((function(){return t.draw()}))},h.prototype.draw=function(){var t=this;if(this.layout&&"string"!=typeof this.layout){this.applyNodeDimensions();var e=this.layout.run(this.graph),n=e instanceof a.Observable?e:a.of(e);this.graphSubscription.add(n.subscribe((function(e){t.graph=e,t.tick()}))),0!==this.graph.nodes.length&&n.pipe(d.first()).subscribe((function(){return t.applyNodeDimensions()}))}},h.prototype.tick=function(){var t=this,e=new Set;this.graph.nodes.map((function(n){n.transform="translate("+(n.position.x-n.dimension.width/2||0)+", "+(n.position.y-n.dimension.height/2||0)+")",n.data||(n.data={}),n.data.color=t.colors.getColor(t.groupResultsBy(n)),e.add(n.id)}));var n=new Set;(this.graph.clusters||[]).map((function(e){e.transform="translate("+(e.position.x-e.dimension.width/2||0)+", "+(e.position.y-e.dimension.height/2||0)+")",e.data||(e.data={}),e.data.color=t.colors.getColor(t.groupResultsBy(e)),n.add(e.id)})),setTimeout((function(){t.oldNodes=e,t.oldClusters=n}),500);var i=[],o=function(t){var e=r.graph.edgeLabels[t],n=t.replace(/[^\w-]*/g,""),o=r.layout&&"string"!=typeof r.layout&&r.layout.settings&&r.layout.settings.multigraph,s=o?r._oldLinks.find((function(t){return""+t.source+t.target+t.id===n})):r._oldLinks.find((function(t){return""+t.source+t.target===n})),a=o?r.graph.edges.find((function(t){return""+t.source+t.target+t.id===n})):r.graph.edges.find((function(t){return""+t.source+t.target===n}));s?s.data&&a&&a.data&&JSON.stringify(s.data)!==JSON.stringify(a.data)&&(s.data=a.data):s=a||e,s.oldLine=s.line;var d=e.points,p=r.generateLine(d),h=Object.assign({},s);h.line=p,h.points=d,r.updateMidpointOnEdge(h,d);var u=d[Math.floor(d.length/2)];u&&(h.textTransform="translate("+(u.x||0)+","+(u.y||0)+")"),h.textAngle=0,h.oldLine||(h.oldLine=h.line),r.calcDominantBaseline(h),i.push(h)},r=this;for(var s in this.graph.edgeLabels)o(s);this.graph.edges=i,this.graph.edges&&(this._oldLinks=this.graph.edges.map((function(t){var e=Object.assign({},t);return e.oldLine=t.line,e}))),this.updateMinimap(),this.autoZoom&&this.zoomToFit(),this.autoCenter&&this.center(),requestAnimationFrame((function(){return t.redrawLines()})),this.cd.markForCheck()},h.prototype.getMinimapTransform=function(){switch(this.miniMapPosition){case t.MiniMapPosition.UpperLeft:return"";case t.MiniMapPosition.UpperRight:return"translate("+(this.dims.width-this.graphDims.width/this.minimapScaleCoefficient)+",0)";default:return""}},h.prototype.updateGraphDims=function(){for(var t=1/0,e=-1/0,n=1/0,i=-1/0,o=0;o<this.graph.nodes.length;o++){var r=this.graph.nodes[o];t=r.position.x<t?r.position.x:t,n=r.position.y<n?r.position.y:n,e=r.position.x+r.dimension.width>e?r.position.x+r.dimension.width:e,i=r.position.y+r.dimension.height>i?r.position.y+r.dimension.height:i}t-=100,n-=100,e+=100,i+=100,this.graphDims.width=e-t,this.graphDims.height=i-n,this.minimapOffsetX=t,this.minimapOffsetY=n},h.prototype.updateMinimap=function(){this.showMiniMap&&this.graph.nodes&&this.graph.nodes.length&&(this.updateGraphDims(),this.miniMapMaxWidth&&(this.minimapScaleCoefficient=this.graphDims.width/this.miniMapMaxWidth),this.miniMapMaxHeight&&(this.minimapScaleCoefficient=Math.max(this.minimapScaleCoefficient,this.graphDims.height/this.miniMapMaxHeight)),this.minimapTransform=this.getMinimapTransform())},h.prototype.applyNodeDimensions=function(){var t=this;this.nodeElements&&this.nodeElements.length&&this.nodeElements.map((function(e){var n,i,o=e.nativeElement,r=t.graph.nodes.find((function(t){return t.id===o.id}));if(r){var s;try{if(!(s=o.getBBox()).width||!s.height)return}catch(t){return}if(t.nodeHeight?r.dimension.height=r.dimension.height&&r.meta.forceDimensions?r.dimension.height:t.nodeHeight:r.dimension.height=r.dimension.height&&r.meta.forceDimensions?r.dimension.height:s.height,t.nodeMaxHeight&&(r.dimension.height=Math.max(r.dimension.height,t.nodeMaxHeight)),t.nodeMinHeight&&(r.dimension.height=Math.min(r.dimension.height,t.nodeMinHeight)),t.nodeWidth)r.dimension.width=r.dimension.width&&r.meta.forceDimensions?r.dimension.width:t.nodeWidth;else if(o.getElementsByTagName("text").length){var a=void 0;try{try{for(var d=x(o.getElementsByTagName("text")),p=d.next();!p.done;p=d.next()){var h=p.value.getBBox();a?(h.width>a.width&&(a.width=h.width),h.height>a.height&&(a.height=h.height)):a=h}}catch(t){n={error:t}}finally{try{p&&!p.done&&(i=d.return)&&i.call(d)}finally{if(n)throw n.error}}}catch(t){return}r.dimension.width=r.dimension.width&&r.meta.forceDimensions?r.dimension.width:a.width+20}else r.dimension.width=r.dimension.width&&r.meta.forceDimensions?r.dimension.width:s.width;t.nodeMaxWidth&&(r.dimension.width=Math.max(r.dimension.width,t.nodeMaxWidth)),t.nodeMinWidth&&(r.dimension.width=Math.min(r.dimension.width,t.nodeMinWidth))}}))},h.prototype.redrawLines=function(t){var e=this;void 0===t&&(t=this.animate),this.linkElements.map((function(n){var o=e.graph.edges.find((function(t){return t.id===n.nativeElement.id}));o&&(i.select(n.nativeElement).select(".line").attr("d",o.oldLine).transition().ease(r.easeSinInOut).duration(t?500:0).attr("d",o.line),i.select(e.chartElement.nativeElement).select("#"+o.id).attr("d",o.oldTextPath).transition().ease(r.easeSinInOut).duration(t?500:0).attr("d",o.textPath),e.updateMidpointOnEdge(o,o.points))}))},h.prototype.calcDominantBaseline=function(t){var e=t.points[0],n=t.points[t.points.length-1];t.oldTextPath=t.textPath,n.x<e.x?(t.dominantBaseline="text-before-edge",t.textPath=this.generateLine(w(t.points).reverse())):(t.dominantBaseline="text-after-edge",t.textPath=t.line)},h.prototype.generateLine=function(t){return o.line().x((function(t){return t.x})).y((function(t){return t.y})).curve(this.curve)(t)},h.prototype.onZoom=function(t,e){if(!this.enableTrackpadSupport||t.ctrlKey){var n=1+("in"===e?this.zoomSpeed:-this.zoomSpeed),i=this.zoomLevel*n;if(!(i<=this.minZoomLevel||i>=this.maxZoomLevel)&&this.enableZoom)if(!0===this.panOnZoom&&t){var o=t.clientX,r=t.clientY,s=this.chart.nativeElement.querySelector("svg"),a=s.querySelector("g.chart"),d=s.createSVGPoint();d.x=o,d.y=r;var p=d.matrixTransform(a.getScreenCTM().inverse());this.pan(p.x,p.y,!0),this.zoom(n),this.pan(-p.x,-p.y,!0)}else this.zoom(n)}else this.pan(-1*t.deltaX,-1*t.deltaY)},h.prototype.pan=function(t,e,n){void 0===n&&(n=!1);var i=n?1:this.zoomLevel;this.transformationMatrix=p.transform(this.transformationMatrix,p.translate(t/i,e/i)),this.updateTransform()},h.prototype.panTo=function(t,e){if(null!=t&&!isNaN(t)&&null!=e&&!isNaN(e)){var n=-this.panOffsetX-t*this.zoomLevel+this.dims.width/2,i=-this.panOffsetY-e*this.zoomLevel+this.dims.height/2;this.transformationMatrix=p.transform(this.transformationMatrix,p.translate(n/this.zoomLevel,i/this.zoomLevel)),this.updateTransform()}},h.prototype.zoom=function(t){this.transformationMatrix=p.transform(this.transformationMatrix,p.scale(t,t)),this.zoomChange.emit(this.zoomLevel),this.updateTransform()},h.prototype.zoomTo=function(t){this.transformationMatrix.a=isNaN(t)?this.transformationMatrix.a:Number(t),this.transformationMatrix.d=isNaN(t)?this.transformationMatrix.d:Number(t),this.zoomChange.emit(this.zoomLevel),this.updateTransform(),this.update()},h.prototype.onDrag=function(t){var e,n,i=this;if(this.draggingEnabled){var o=this.draggingNode;this.layout&&"string"!=typeof this.layout&&this.layout.onDrag&&this.layout.onDrag(o,t),o.position.x+=t.movementX/this.zoomLevel,o.position.y+=t.movementY/this.zoomLevel;var r=o.position.x-o.dimension.width/2,s=o.position.y-o.dimension.height/2;o.transform="translate("+r+", "+s+")";var d=function(t){if((t.target===o.id||t.source===o.id||t.target.id===o.id||t.source.id===o.id)&&p.layout&&"string"!=typeof p.layout){var e=p.layout.updateEdge(p.graph,t),n=e instanceof a.Observable?e:a.of(e);p.graphSubscription.add(n.subscribe((function(e){i.graph=e,i.redrawEdge(t)})))}},p=this;try{for(var h=x(this.graph.edges),u=h.next();!u.done;u=h.next()){d(u.value)}}catch(t){e={error:t}}finally{try{u&&!u.done&&(n=h.return)&&n.call(h)}finally{if(e)throw e.error}}this.redrawLines(!1),this.updateMinimap()}},h.prototype.redrawEdge=function(t){var e=this.generateLine(t.points);this.calcDominantBaseline(t),t.oldLine=t.line,t.line=e},h.prototype.updateTransform=function(){this.transform=p.toSVG(p.smoothMatrix(this.transformationMatrix,100))},h.prototype.onClick=function(t){this.select.emit(t)},h.prototype.onActivate=function(t){this.activeEntries.indexOf(t)>-1||(this.activeEntries=w([t],this.activeEntries),this.activate.emit({value:t,entries:this.activeEntries}))},h.prototype.onDeactivate=function(t){var e=this.activeEntries.indexOf(t);this.activeEntries.splice(e,1),this.activeEntries=w(this.activeEntries),this.deactivate.emit({value:t,entries:this.activeEntries})},h.prototype.getSeriesDomain=function(){var t=this;return this.nodes.map((function(e){return t.groupResultsBy(e)})).reduce((function(t,e){return-1!==t.indexOf(e)?t:t.concat([e])}),[]).sort()},h.prototype.trackLinkBy=function(t,e){return e.id},h.prototype.trackNodeBy=function(t,e){return e.id},h.prototype.setColors=function(){this.colors=new n.ColorHelper(this.scheme,"ordinal",this.seriesDomain,this.customColors)},h.prototype.getLegendOptions=function(){return{scaleType:"ordinal",domain:this.seriesDomain,colors:this.colors}},h.prototype.onMouseMove=function(t){this.isMouseMoveCalled=!0,(this.isPanning||this.isMinimapPanning)&&this.panningEnabled?this.panWithConstraints(this.panningAxis,t):this.isDragging&&this.draggingEnabled&&this.onDrag(t)},h.prototype.onMouseDown=function(t){this.isMouseMoveCalled=!1},h.prototype.graphClick=function(t){this.isMouseMoveCalled||this.clickHandler.emit(t)},h.prototype.onTouchStart=function(t){this._touchLastX=t.changedTouches[0].clientX,this._touchLastY=t.changedTouches[0].clientY,this.isPanning=!0},h.prototype.onTouchMove=function(t){if(this.isPanning&&this.panningEnabled){var e=t.changedTouches[0].clientX,n=t.changedTouches[0].clientY,i=e-this._touchLastX,o=n-this._touchLastY;this._touchLastX=e,this._touchLastY=n,this.pan(i,o)}},h.prototype.onTouchEnd=function(t){this.isPanning=!1},h.prototype.onMouseUp=function(t){this.isDragging=!1,this.isPanning=!1,this.isMinimapPanning=!1,this.layout&&"string"!=typeof this.layout&&this.layout.onDragEnd&&this.layout.onDragEnd(this.draggingNode,t)},h.prototype.onNodeMouseDown=function(t,e){this.draggingEnabled&&(this.isDragging=!0,this.draggingNode=e,this.layout&&"string"!=typeof this.layout&&this.layout.onDragStart&&this.layout.onDragStart(e,t))},h.prototype.onMinimapDragMouseDown=function(){this.isMinimapPanning=!0},h.prototype.onMinimapPanTo=function(t){var e=t.offsetX-(this.dims.width-(this.graphDims.width+this.minimapOffsetX)/this.minimapScaleCoefficient),n=t.offsetY+this.minimapOffsetY/this.minimapScaleCoefficient;this.panTo(e*this.minimapScaleCoefficient,n*this.minimapScaleCoefficient),this.isMinimapPanning=!0},h.prototype.center=function(){this.panTo(this.graphDims.width/2,this.graphDims.height/2)},h.prototype.zoomToFit=function(){var t=this.dims.height/this.graphDims.height,e=this.dims.width/this.graphDims.width,n=Math.min(t,e,1);n<this.minZoomLevel&&(n=this.minZoomLevel),n>this.maxZoomLevel&&(n=this.maxZoomLevel),n!==this.zoomLevel&&(this.zoomLevel=n,this.updateTransform(),this.zoomChange.emit(this.zoomLevel))},h.prototype.panToNodeId=function(t){var e=this.graph.nodes.find((function(e){return e.id===t}));e&&this.panTo(e.position.x,e.position.y)},h.prototype.panWithConstraints=function(e,n){var i=n.movementX,o=n.movementY;switch(this.isMinimapPanning&&(i=-this.minimapScaleCoefficient*i*this.zoomLevel,o=-this.minimapScaleCoefficient*o*this.zoomLevel),e){case t.PanningAxis.Horizontal:this.pan(i,0);break;case t.PanningAxis.Vertical:this.pan(0,o);break;default:this.pan(i,o)}},h.prototype.updateMidpointOnEdge=function(t,e){if(t&&e)if(e.length%2==1)t.midPoint=e[Math.floor(e.length/2)];else{var n=e[e.length/2],i=e[e.length/2-1];t.midPoint={x:(n.x+i.x)/2,y:(n.y+i.y)/2}}},h.ctorParameters=function(){return[{type:e.ElementRef},{type:e.NgZone},{type:e.ChangeDetectorRef},{type:z}]},y([e.Input(),v("design:type",Boolean)],h.prototype,"legend",void 0),y([e.Input(),v("design:type",Array)],h.prototype,"nodes",void 0),y([e.Input(),v("design:type",Array)],h.prototype,"clusters",void 0),y([e.Input(),v("design:type",Array)],h.prototype,"links",void 0),y([e.Input(),v("design:type",Array)],h.prototype,"activeEntries",void 0),y([e.Input(),v("design:type",Object)],h.prototype,"curve",void 0),y([e.Input(),v("design:type",Object)],h.prototype,"draggingEnabled",void 0),y([e.Input(),v("design:type",Number)],h.prototype,"nodeHeight",void 0),y([e.Input(),v("design:type",Number)],h.prototype,"nodeMaxHeight",void 0),y([e.Input(),v("design:type",Number)],h.prototype,"nodeMinHeight",void 0),y([e.Input(),v("design:type",Number)],h.prototype,"nodeWidth",void 0),y([e.Input(),v("design:type",Number)],h.prototype,"nodeMinWidth",void 0),y([e.Input(),v("design:type",Number)],h.prototype,"nodeMaxWidth",void 0),y([e.Input(),v("design:type",Boolean)],h.prototype,"panningEnabled",void 0),y([e.Input(),v("design:type",String)],h.prototype,"panningAxis",void 0),y([e.Input(),v("design:type",Object)],h.prototype,"enableZoom",void 0),y([e.Input(),v("design:type",Object)],h.prototype,"zoomSpeed",void 0),y([e.Input(),v("design:type",Object)],h.prototype,"minZoomLevel",void 0),y([e.Input(),v("design:type",Object)],h.prototype,"maxZoomLevel",void 0),y([e.Input(),v("design:type",Object)],h.prototype,"autoZoom",void 0),y([e.Input(),v("design:type",Object)],h.prototype,"panOnZoom",void 0),y([e.Input(),v("design:type",Object)],h.prototype,"animate",void 0),y([e.Input(),v("design:type",Object)],h.prototype,"autoCenter",void 0),y([e.Input(),v("design:type",a.Observable)],h.prototype,"update$",void 0),y([e.Input(),v("design:type",a.Observable)],h.prototype,"center$",void 0),y([e.Input(),v("design:type",a.Observable)],h.prototype,"zoomToFit$",void 0),y([e.Input(),v("design:type",a.Observable)],h.prototype,"panToNode$",void 0),y([e.Input(),v("design:type",Object)],h.prototype,"layout",void 0),y([e.Input(),v("design:type",Object)],h.prototype,"layoutSettings",void 0),y([e.Input(),v("design:type",Object)],h.prototype,"enableTrackpadSupport",void 0),y([e.Input(),v("design:type",Boolean)],h.prototype,"showMiniMap",void 0),y([e.Input(),v("design:type",Number)],h.prototype,"miniMapMaxWidth",void 0),y([e.Input(),v("design:type",Number)],h.prototype,"miniMapMaxHeight",void 0),y([e.Input(),v("design:type",String)],h.prototype,"miniMapPosition",void 0),y([e.Output(),v("design:type",e.EventEmitter)],h.prototype,"activate",void 0),y([e.Output(),v("design:type",e.EventEmitter)],h.prototype,"deactivate",void 0),y([e.Output(),v("design:type",e.EventEmitter)],h.prototype,"zoomChange",void 0),y([e.Output(),v("design:type",e.EventEmitter)],h.prototype,"clickHandler",void 0),y([e.ContentChild("linkTemplate"),v("design:type",e.TemplateRef)],h.prototype,"linkTemplate",void 0),y([e.ContentChild("nodeTemplate"),v("design:type",e.TemplateRef)],h.prototype,"nodeTemplate",void 0),y([e.ContentChild("clusterTemplate"),v("design:type",e.TemplateRef)],h.prototype,"clusterTemplate",void 0),y([e.ContentChild("defsTemplate"),v("design:type",e.TemplateRef)],h.prototype,"defsTemplate",void 0),y([e.ContentChild("miniMapNodeTemplate"),v("design:type",e.TemplateRef)],h.prototype,"miniMapNodeTemplate",void 0),y([e.ViewChild(n.ChartComponent,{read:e.ElementRef,static:!0}),v("design:type",e.ElementRef)],h.prototype,"chart",void 0),y([e.ViewChildren("nodeElement"),v("design:type",e.QueryList)],h.prototype,"nodeElements",void 0),y([e.ViewChildren("linkElement"),v("design:type",e.QueryList)],h.prototype,"linkElements",void 0),y([e.Input(),v("design:type",Function)],h.prototype,"groupResultsBy",void 0),y([e.Input("zoomLevel"),v("design:type",Object),v("design:paramtypes",[Object])],h.prototype,"zoomLevel",null),y([e.Input("panOffsetX"),v("design:type",Object),v("design:paramtypes",[Object])],h.prototype,"panOffsetX",null),y([e.Input("panOffsetY"),v("design:type",Object),v("design:paramtypes",[Object])],h.prototype,"panOffsetY",null),y([F(500),v("design:type",Function),v("design:paramtypes",[]),v("design:returntype",void 0)],h.prototype,"updateMinimap",null),y([e.HostListener("document:mousemove",["$event"]),v("design:type",Function),v("design:paramtypes",[MouseEvent]),v("design:returntype",void 0)],h.prototype,"onMouseMove",null),y([e.HostListener("document:mousedown",["$event"]),v("design:type",Function),v("design:paramtypes",[MouseEvent]),v("design:returntype",void 0)],h.prototype,"onMouseDown",null),y([e.HostListener("document:click",["$event"]),v("design:type",Function),v("design:paramtypes",[MouseEvent]),v("design:returntype",void 0)],h.prototype,"graphClick",null),y([e.HostListener("document:touchmove",["$event"]),v("design:type",Function),v("design:paramtypes",[Object]),v("design:returntype",void 0)],h.prototype,"onTouchMove",null),y([e.HostListener("document:mouseup",["$event"]),v("design:type",Function),v("design:paramtypes",[MouseEvent]),v("design:returntype",void 0)],h.prototype,"onMouseUp",null),h=y([e.Component({selector:"ngx-graph",template:'<ngx-charts-chart\n  [view]="[width, height]"\n  [showLegend]="legend"\n  [legendOptions]="legendOptions"\n  (legendLabelClick)="onClick($event)"\n  (legendLabelActivate)="onActivate($event)"\n  (legendLabelDeactivate)="onDeactivate($event)"\n  mouseWheel\n  (mouseWheelUp)="onZoom($event, \'in\')"\n  (mouseWheelDown)="onZoom($event, \'out\')"\n>\n  <svg:g\n    *ngIf="initialized && graph"\n    [attr.transform]="transform"\n    (touchstart)="onTouchStart($event)"\n    (touchend)="onTouchEnd($event)"\n    class="graph chart"\n  >\n    <defs>\n      <ng-container *ngIf="defsTemplate" [ngTemplateOutlet]="defsTemplate"></ng-container>\n      <svg:path\n        class="text-path"\n        *ngFor="let link of graph.edges"\n        [attr.d]="link.textPath"\n        [attr.id]="link.id"\n      ></svg:path>\n    </defs>\n\n    <svg:rect\n      class="panning-rect"\n      [attr.width]="dims.width * 100"\n      [attr.height]="dims.height * 100"\n      [attr.transform]="\'translate(\' + (-dims.width || 0) * 50 + \',\' + (-dims.height || 0) * 50 + \')\'"\n      (mousedown)="isPanning = true"\n    />\n\n    <ng-content></ng-content>\n\n    <svg:g class="clusters">\n      <svg:g\n        #clusterElement\n        *ngFor="let node of graph.clusters; trackBy: trackNodeBy"\n        class="node-group"\n        [class.old-node]="animate && oldClusters.has(node.id)"\n        [id]="node.id"\n        [attr.transform]="node.transform"\n        (click)="onClick(node)"\n      >\n        <ng-container\n          *ngIf="clusterTemplate"\n          [ngTemplateOutlet]="clusterTemplate"\n          [ngTemplateOutletContext]="{ $implicit: node }"\n        ></ng-container>\n        <svg:g *ngIf="!clusterTemplate" class="node cluster">\n          <svg:rect\n            [attr.width]="node.dimension.width"\n            [attr.height]="node.dimension.height"\n            [attr.fill]="node.data?.color"\n          />\n          <svg:text alignment-baseline="central" [attr.x]="10" [attr.y]="node.dimension.height / 2">\n            {{ node.label }}\n          </svg:text>\n        </svg:g>\n      </svg:g>\n    </svg:g>\n\n    <svg:g class="links">\n      <svg:g #linkElement *ngFor="let link of graph.edges; trackBy: trackLinkBy" class="link-group" [id]="link.id">\n        <ng-container\n          *ngIf="linkTemplate"\n          [ngTemplateOutlet]="linkTemplate"\n          [ngTemplateOutletContext]="{ $implicit: link }"\n        ></ng-container>\n        <svg:path *ngIf="!linkTemplate" class="edge" [attr.d]="link.line" />\n      </svg:g>\n    </svg:g>\n\n    <svg:g class="nodes">\n      <svg:g\n        #nodeElement\n        *ngFor="let node of graph.nodes; trackBy: trackNodeBy"\n        class="node-group"\n        [class.old-node]="animate && oldNodes.has(node.id)"\n        [id]="node.id"\n        [attr.transform]="node.transform"\n        (click)="onClick(node)"\n        (mousedown)="onNodeMouseDown($event, node)"\n      >\n        <ng-container\n          *ngIf="nodeTemplate"\n          [ngTemplateOutlet]="nodeTemplate"\n          [ngTemplateOutletContext]="{ $implicit: node }"\n        ></ng-container>\n        <svg:circle\n          *ngIf="!nodeTemplate"\n          r="10"\n          [attr.cx]="node.dimension.width / 2"\n          [attr.cy]="node.dimension.height / 2"\n          [attr.fill]="node.data?.color"\n        />\n      </svg:g>\n    </svg:g>\n  </svg:g>\n\n  <svg:clipPath [attr.id]="minimapClipPathId">\n    <svg:rect\n      [attr.width]="graphDims.width / minimapScaleCoefficient"\n      [attr.height]="graphDims.height / minimapScaleCoefficient"\n    ></svg:rect>\n  </svg:clipPath>\n\n  <svg:g\n    class="minimap"\n    *ngIf="showMiniMap"\n    [attr.transform]="minimapTransform"\n    [attr.clip-path]="\'url(#\' + minimapClipPathId + \')\'"\n  >\n    <svg:rect\n      class="minimap-background"\n      [attr.width]="graphDims.width / minimapScaleCoefficient"\n      [attr.height]="graphDims.height / minimapScaleCoefficient"\n      (mousedown)="onMinimapPanTo($event)"\n    ></svg:rect>\n\n    <svg:g\n      [style.transform]="\n        \'translate(\' +\n        -minimapOffsetX / minimapScaleCoefficient +\n        \'px,\' +\n        -minimapOffsetY / minimapScaleCoefficient +\n        \'px)\'\n      "\n    >\n      <svg:g class="minimap-nodes" [style.transform]="\'scale(\' + 1 / minimapScaleCoefficient + \')\'">\n        <svg:g\n          #nodeElement\n          *ngFor="let node of graph.nodes; trackBy: trackNodeBy"\n          class="node-group"\n          [class.old-node]="animate && oldNodes.has(node.id)"\n          [id]="node.id"\n          [attr.transform]="node.transform"\n        >\n          <ng-container\n            *ngIf="miniMapNodeTemplate"\n            [ngTemplateOutlet]="miniMapNodeTemplate"\n            [ngTemplateOutletContext]="{ $implicit: node }"\n          ></ng-container>\n          <ng-container\n            *ngIf="!miniMapNodeTemplate && nodeTemplate"\n            [ngTemplateOutlet]="nodeTemplate"\n            [ngTemplateOutletContext]="{ $implicit: node }"\n          ></ng-container>\n          <svg:circle\n            *ngIf="!nodeTemplate && !miniMapNodeTemplate"\n            r="10"\n            [attr.cx]="node.dimension.width / 2 / minimapScaleCoefficient"\n            [attr.cy]="node.dimension.height / 2 / minimapScaleCoefficient"\n            [attr.fill]="node.data?.color"\n          />\n        </svg:g>\n      </svg:g>\n\n      <svg:rect\n        [attr.transform]="\n          \'translate(\' +\n          panOffsetX / zoomLevel / -minimapScaleCoefficient +\n          \',\' +\n          panOffsetY / zoomLevel / -minimapScaleCoefficient +\n          \')\'\n        "\n        class="minimap-drag"\n        [class.panning]="isMinimapPanning"\n        [attr.width]="width / minimapScaleCoefficient / zoomLevel"\n        [attr.height]="height / minimapScaleCoefficient / zoomLevel"\n        (mousedown)="onMinimapDragMouseDown()"\n      ></svg:rect>\n    </svg:g>\n  </svg:g>\n</ngx-charts-chart>\n',encapsulation:e.ViewEncapsulation.None,changeDetection:e.ChangeDetectionStrategy.OnPush,styles:[".minimap .minimap-background{fill:rgba(0,0,0,.1)}.minimap .minimap-drag{fill:rgba(0,0,0,.2);stroke:#fff;stroke-width:1px;stroke-dasharray:2px;stroke-dashoffset:2px;cursor:pointer}.minimap .minimap-drag.panning{fill:rgba(0,0,0,.3)}.minimap .minimap-nodes{opacity:.5;pointer-events:none}.graph{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.graph .edge{stroke:#666;fill:none}.graph .edge .edge-label{stroke:none;font-size:12px;fill:#251e1e}.graph .panning-rect{fill:transparent;cursor:move}.graph .node-group.old-node{transition:transform .5s ease-in-out}.graph .node-group .node:focus{outline:0}.graph .cluster rect{opacity:.2}"]}),v("design:paramtypes",[e.ElementRef,e.NgZone,e.ChangeDetectorRef,z])],h)}(n.BaseChartComponent),W=function(){function t(){this.mouseWheelUp=new e.EventEmitter,this.mouseWheelDown=new e.EventEmitter}return t.prototype.onMouseWheelChrome=function(t){this.mouseWheelFunc(t)},t.prototype.onMouseWheelFirefox=function(t){this.mouseWheelFunc(t)},t.prototype.onWheel=function(t){this.mouseWheelFunc(t)},t.prototype.onMouseWheelIE=function(t){this.mouseWheelFunc(t)},t.prototype.mouseWheelFunc=function(t){window.event&&(t=window.event);var e=Math.max(-1,Math.min(1,t.wheelDelta||-t.detail||t.deltaY||t.deltaX)),n=t.wheelDelta?e>0:e<0,i=t.wheelDelta?e<0:e>0;n?this.mouseWheelUp.emit(t):i&&this.mouseWheelDown.emit(t),t.returnValue=!1,t.preventDefault&&t.preventDefault()},y([e.Output(),v("design:type",Object)],t.prototype,"mouseWheelUp",void 0),y([e.Output(),v("design:type",Object)],t.prototype,"mouseWheelDown",void 0),y([e.HostListener("mousewheel",["$event"]),v("design:type",Function),v("design:paramtypes",[Object]),v("design:returntype",void 0)],t.prototype,"onMouseWheelChrome",null),y([e.HostListener("DOMMouseScroll",["$event"]),v("design:type",Function),v("design:paramtypes",[Object]),v("design:returntype",void 0)],t.prototype,"onMouseWheelFirefox",null),y([e.HostListener("wheel",["$event"]),v("design:type",Function),v("design:paramtypes",[Object]),v("design:returntype",void 0)],t.prototype,"onWheel",null),y([e.HostListener("onmousewheel",["$event"]),v("design:type",Function),v("design:paramtypes",[Object]),v("design:returntype",void 0)],t.prototype,"onMouseWheelIE",null),t=y([e.Directive({selector:"[mouseWheel]"})],t)}(),B=function(){function t(){}return t=y([e.NgModule({imports:[n.ChartCommonModule],declarations:[$,W],exports:[$,W],providers:[z]})],t)}(),R=function(){function t(){}return t=y([e.NgModule({imports:[n.NgxChartsModule],exports:[B]})],t)}();t.ColaForceDirectedLayout=P,t.D3ForceDirectedLayout=S,t.DagreClusterLayout=D,t.DagreLayout=L,t.DagreNodesOnlyLayout=E,t.GraphComponent=$,t.GraphModule=B,t.MouseWheelDirective=W,t.NgxGraphModule=R,t.toD3Node=k,t.toNode=C,t.ɵa=z,t.ɵb=F,Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=swimlane-ngx-graph.umd.min.js.map